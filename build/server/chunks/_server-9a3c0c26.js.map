{"version":3,"file":"_server-9a3c0c26.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/kmeans_colors/_server.js"],"sourcesContent":["import { j as json } from \"../../../../chunks/index.js\";\nimport { mkdir, writeFile } from \"node:fs/promises\";\nimport ShortUniqueId from \"short-unique-id\";\nimport { s as storage_path } from \"../../../../chunks/config.js\";\nimport { k as kmeansColors } from \"../../../../chunks/pdf.js\";\nconst saveFromBase64 = async (base64Images) => {\n  try {\n    const filedir = `${storage_path}/tmp/${new ShortUniqueId()()}`;\n    await mkdir(filedir, { recursive: true });\n    base64Images.forEach(async (image, index) => {\n      const buffer = Buffer.from(image.replace(\"data:image/png;base64,\", \"\"), \"base64\");\n      await writeFile(`${filedir}/page-${index}.png`, buffer, { flag: \"w+\" });\n    });\n    return filedir;\n  } catch (error) {\n    console.log(error);\n  }\n};\nconst POST = async ({ request, locals, cookies }) => {\n  const images = await request.json();\n  const base64Images = images.map((image) => {\n    return image.url;\n  });\n  const filedir = await saveFromBase64(base64Images);\n  let kmeans_colors = [];\n  for (let i = 0; i < images.length; i++) {\n    const imagepath = `${filedir}/page-${i}.png`;\n    const color = await kmeansColors(imagepath);\n    kmeans_colors = [...kmeans_colors, color];\n  }\n  return json({\n    kmeans_colors\n  });\n};\nexport {\n  POST\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;AAKA,MAAM,cAAc,GAAG,OAAO,YAAY,KAAK;AAC/C,EAAE,IAAI;AACN,IAAI,MAAM,OAAO,GAAG,CAAC,EAAE,YAAY,CAAC,KAAK,EAAE,IAAI,aAAa,EAAE,EAAE,CAAC,CAAC,CAAC;AACnE,IAAI,MAAM,KAAK,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;AAC9C,IAAI,YAAY,CAAC,OAAO,CAAC,OAAO,KAAK,EAAE,KAAK,KAAK;AACjD,MAAM,MAAM,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,wBAAwB,EAAE,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC;AACxF,MAAM,MAAM,SAAS,CAAC,CAAC,EAAE,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;AAC9E,KAAK,CAAC,CAAC;AACP,IAAI,OAAO,OAAO,CAAC;AACnB,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;AACvB,GAAG;AACH,CAAC,CAAC;AACG,MAAC,IAAI,GAAG,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK;AACrD,EAAE,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;AACtC,EAAE,MAAM,YAAY,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,KAAK;AAC7C,IAAI,OAAO,KAAK,CAAC,GAAG,CAAC;AACrB,GAAG,CAAC,CAAC;AACL,EAAE,MAAM,OAAO,GAAG,MAAM,cAAc,CAAC,YAAY,CAAC,CAAC;AACrD,EAAE,IAAI,aAAa,GAAG,EAAE,CAAC;AACzB,EAAE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AAC1C,IAAI,MAAM,SAAS,GAAG,CAAC,EAAE,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC;AACjD,IAAI,MAAM,KAAK,GAAG,MAAM,YAAY,CAAC,SAAS,CAAC,CAAC;AAChD,IAAI,aAAa,GAAG,CAAC,GAAG,aAAa,EAAE,KAAK,CAAC,CAAC;AAC9C,GAAG;AACH,EAAE,OAAO,IAAI,CAAC;AACd,IAAI,aAAa;AACjB,GAAG,CAAC,CAAC;AACL;;;;"}